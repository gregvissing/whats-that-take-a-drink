<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        @import "https://unpkg.com/open-props/open-props.min.css";
        @import "https://unpkg.com/open-props/normalize.min.css";

        * {
            box-sizing: border-box;
        }

        :root {
            --recording: 0;
        }

        body {
            display: grid;
            place-items: center;
            min-height: 100vh;
        }

        main {
            max-inline-size: var(--size-content-1);
            font-family: 'Google Sans', sans-serif;
            font-size: var(--font-size-fluid-1);
        }

        .recording-status {
            display:none;
            height: 5vmin;
            aspect-ratio: 1;
            position: fixed;
            top: 2vmin;
            right: 2vmin;
            background: hsl(10 80% 50%);
            border-radius: 50%;
            animation: pulse calc(var(--recording, 0) * 1s) infinite ease-in-out;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
        }

        .instruction {
            opacity: 0.6;
            display: none;
        }


        .emojis {
            display: flex;
            gap: 1rem;
        }

        .emojis div {
            font-size: 10vmin;
        }
    </style>
</head>
<body>
    <main><span class="instruction">Start Speaking!</main>
    <div class="recording-status"></div>
    <span class="emojis"></span>
    <script>
        window.SpeechRecognition =
        window.SpeechRecognition || window.webkitSpeechRecognition

        const RECOG = new window.SpeechRecognition()
        RECOG.continuous = true
        RECOG.interimResults = true


        const STATE = {
        RUNNING: false,
        }

        const START = () => {
        if (!STATE.RUNNING) {
            STATE.RUNNING = true
            document.body.style.setProperty("--recording", 1)
            RECOG.start()
        }
        }

        const PARTICLES = [
        {
            trigger: "what's that",
            emoji: "Take a ðŸº"
        },
        /*
        {
            trigger: "lit",
            emoji: "ðŸ”¥"
        },
        {
            trigger: "boom",
            emoji: "ðŸ’£"
        },
        {
            trigger: "wood",
            emoji: "ðŸŒ´",
        },
        {
            trigger: "chuck",
            emoji: "ðŸª“"
        },
        {
            trigger: "poop",
            emoji: "ðŸ’©"
        },
        {
            trigger: "unicorn",
            emoji: "ðŸ¦„"
        },
        {
            trigger: "rainbow",
            emoji: "ðŸŒˆ"
        },
        {
            trigger: "pizza",
            emoji: "ðŸ•"
        },
        {
            trigger: "cake",
            emoji: "ðŸŽ‚"
        },
        {
            trigger: "slice",
            emoji: "ðŸ°"
        },
        {
            trigger: "cupcake",
            emoji: "ðŸ§"
        },
        {
            trigger: "cream",
            emoji: "ðŸ¦"
        },
        {
            trigger: "pie",
            emoji: "ðŸ¥§"
        },
        {
            trigger: "sundae",
            emoji: "ðŸ¨"
        },
        {
            trigger: "kona",
            emoji: "ðŸ§"
        },
        {
            trigger: "cake pop",
            emoji: "ðŸ¡"
        },
        {
            trigger: "softball",
            emoji: "ðŸ¥Ž"
        },
        {
            trigger: "chocolate",
            emoji: "ðŸ«"
        },
        {
            trigger: "heart",
            emoji: "ðŸ’œ"
        },
        {
            trigger: "circle",
            emoji: "ðŸŸ£"
        },
        {
            trigger: "square",
            emoji: "ðŸŸª"
        },
        {
            trigger: "flag",
            emoji: "ðŸ‡ºðŸ‡¸"
        },
        {
            trigger: "donut",
            emoji: "ðŸ©"
        },
        {
            trigger: "bunny",
            emoji: "ðŸ°"
        },
        {
            trigger: "hamster",
            emoji: "ðŸ¹"
        },
        {
            trigger: "dog",
            emoji: "ðŸ¶"
        },
        {
            trigger: "penguin",
            emoji: "ðŸ§"
        },
        {
            trigger: "fairy",
            emoji: "ðŸ§š"
        },
        {
            trigger: "gift",
            emoji: "ðŸŽ"
        },
        {
            trigger: "mermaid",
            emoji: "ðŸ§œâ€"
        },
        {
            trigger: "dress",
            emoji: "ðŸ‘—"
        },
        {
            trigger: "hat",
            emoji: "ðŸ‘’"
        },
        {
            trigger: "koala",
            emoji: "ðŸ¨"
        },
        {
            trigger: "fox",
            emoji: "ðŸ¦Š"
        },
        {
            trigger: "panda",
            emoji: "ðŸ¼"
        },
        {
            trigger: "egg",
            emoji: "ðŸ£"
        },
        {
            trigger: "chick",
            emoji: "ðŸ¥"
        },
        {
            trigger: "toilet paper",
            emoji: "ðŸ§»"
        },
        {
            trigger: "burger",
            emoji: "ðŸ”"
        },
        {
            trigger: "money bag",
            emoji: "ðŸ’°"
        },
        {
            trigger: "flying money",
            emoji: "ðŸ’¸"
        } */
        //  
        ] 

        const EMOJIS = document.querySelector(".emojis")
        const PROCESS_AUDIO = e => {
        const TRANSCRIPT = e.results[e.results.length - 1][0].transcript
            .toLowerCase()
            .trim()
        for (const PARTICLE of PARTICLES) {
            if (TRANSCRIPT.indexOf(PARTICLE.trigger) !== -1) {
            const P = document.createElement("div")
            P.innerText = PARTICLE.emoji
            P.className = PARTICLE.trigger
            EMOJIS.appendChild(P)
            if (PARTICLE.trigger === "wood" || PARTICLE.trigger === "chuck") {
                P.addEventListener("animationend", () => {
                P.remove()
                })
            }
            P.style.setProperty("--index", EMOJIS.children.length)
            }
        }
        document.querySelector("main").innerText = TRANSCRIPT
        }

        RECOG.onresult = PROCESS_AUDIO


        START()
    </script>
</body>
</html>
